function loader(){$.ajax({url:$.baseurl+"seatplan_ajax.php?mode=load"+$.ie+"&cPath="+$.cPath,dataType:"json",success:function(t){t.cart&&(0<t.cart.length&&void 0===$.timer&&($("div#ajax_status").slideDown(200),$.timer=setInterval(countdown,1e3)),0==t.cart.length&&"number"==typeof $.timer&&(clearInterval($.timer),delete $.timer,$("div#ajax_status").slideUp(200).empty(),count=$.lifetime),$.each(t.cart,function(t,a){$("li#s"+a).hasClass("s")&&($.cls=$("li#s"+a).attr("class").match(/(bl|rd|gr|or|fu|ye|sa|sb|te|th|pg)/gi),null!=$.cls&&$("li#s"+a).removeClass("s").removeClass($.cls.toString()).addClass("y").addClass(flip($.cls.toString())))})),t.sold&&$.each(t.sold,function(t,a){}),t.lock&&$.each(t.lock,function(t,a){}),t.prev&&$.each(t.prev,function(t,a){}),t.shopping_box&&($("#box_ajaxCart").html(t.shopping_box),alert(lng.tooslow))}})}function freeSeats(){$.ajax({url:$.baseurl+"seatplan_ajax.php?mode=free"+$.ie+"&cPath="+$.cPath,dataType:"json",success:function(t){t.free&&$.each(t.free,function(t,a){$("li#s"+a).hasClass("z")&&$("li#s"+a).removeClass("z").addClass("s")})}})}function bindTriggers(){$(".s").bind("click",function(){$("div.ticket_discount").is(":hidden")||$("div#ticket_discount").fadeOut(),$("div#indicator").hasClass("activity")||($("div#indicator").fadeIn(40,function(){$(this).addClass("activity")}),clearInterval($.tick),clearInterval($.free),$(this).attr("id")&&($.id=$(this).attr("id").replace(/s/,""),$(this).hasClass("y")?1==$("li#s"+$.id).length&&($("li#s"+$.id).addClass("activity_off"),$.ajax({url:"seatplan_ajax.php",data:"mode=remove_seat"+$.ie+"&cPath="+$.cPath+"&products_id="+$.id,dataType:"json",success:function(t){$.cls=$("li#s"+$.id).attr("class").match(/(lb|dr|rg|ro|uf|ey|as|bs|et|ht|gp)/gi),null!=$.cls&&$("li#s"+$.id).removeClass("y").removeClass($.cls.toString()).addClass("s").addClass(flip($.cls.toString())),$("li#c"+$.id).effect("transfer",{to:$("li#s"+$.id)},120,function(){$("li#c"+$.id).fadeOut(400).remove(),updateTotals()}),$("div#indicator").fadeOut(200,function(){$(this).removeClass("activity")}),$("li#s"+$.id).removeClass("activity_off")}})):($("li#s"+$.id).addClass("activity_on"),$.ajax({url:"seatplan_ajax.php",data:"mode=add_seat"+$.ie+"&cPath="+$.cPath+"&products_id="+$.id,dataType:"json",success:function(t){if(t.denied?alert(lng.tooslow):t.max?alert(lng.toomany):$("li#s"+$.id).effect("transfer",{to:$("ul#ajax_cart")},120,function(){$.title=$("li#s"+$.id)[0]._title.split(" - ",2),$.ticket_color=$("li#s"+$.id).attr("class").match(/(lb|dr|rg|ro|uf|ey|as|bs|et|ht|gp)/gi),$.html='<li id="c'+$.id+'" class="c '+flip($.ticket_color.toString())+'"><span class="cht">'+$.cht+'</span></br><span class="pn"><a href="'+$.baseurl+"product_info.php?products_id="+$.id+'">'+$.title[0]+'</a></span><span class="cnt">1</span><div id="del'+$.id+'" class="bd"></div><span class="pp">'+$.title[1]+'</span><span class="res"  style="display:none">'+t.sum_res+"</span></li>",$("ul#ajax_cart").append($.html),count=parseInt(t.remaining),updateTotals()}),t.discounts){for(var a="",i=0;i<t.discounts.length;i++)a+='<li data-choice_warning="'+t.discounts[i].choice_warning+'" data-sale_id="'+t.discounts[i].sale_id+'" id="'+t.discounts[i].discounted_price+'" class="xx '+t.granted+'">'+t.discounts[i].description+"</li>";a+='<li id="kill_discount"><strong>X</strong> '+$.thank+"</li>",$("ul#discount").html(a),$("#discount_show_name").html(t.show_name),$("#discount_products_name").html(t.products_name),$("div#ticket_discount").fadeIn()}$.cls=$("li#s"+$.id).attr("class").match(/(bl|rd|gr|or|fu|ye|sa|sb|te|th|pg)/gi),null==$.cls||t.max||$("li#s"+$.id).removeClass("s").removeClass($.cls.toString()).addClass("y").addClass(flip($.cls.toString())),$("div#indicator").fadeOut(200,function(){$(this).removeClass("activity")}),$("li#s"+$.id).removeClass("activity_on")}})),$.tick=setInterval("loader();",$.refresh),$.free=setInterval("freeSeats();",24*$.refresh)))}),$(".bd").on("click",function(){return $.id=$(this).attr("id").replace("del",""),0!=$("li#s"+$.id).length?($("li#s"+$.id).trigger("click"),!1):($("div#indicator").fadeIn(40,function(){$(this).addClass("activity")}),void $.ajax({url:"seatplan_ajax.php",data:"mode=remove_seat"+$.ie+"&cPath="+$.cPath+"&products_id="+$.id,dataType:"json",success:function(t){$("li#c"+$.id).effect("puff",200,function(){0<$("tr#p"+$.id).length&&$("tr#p"+$.id).fadeOut(400,function(){$(this).remove()}),$("li#c"+$.id).remove(),updateTotals()}),$("div#indicator").fadeOut(220,function(){$(this).removeClass("activity")}),0==$("ul#ajax_cart").children("li.c").length&&(clearInterval($.timer),$("div#ajax_status").slideUp(200).empty(),count=parseInt($.lifetime),delete $.timer)}}))}),$(".c").on("click",function(){$.id=$(this).attr("id").replace("c",""),1==$("li#s"+$.id).length&&$("li#s"+$.id).effect("pulsate",{times:2,mode:"show"},360)}),$(".xx").on("click",function(){return isNaN(parseInt($("input#qty").val()))&&$("input#qty").val("1"),$(this).attr("class")&&($the_id=$(this).attr("class").replace(/xx/,"")),$(this).attr("id")&&($the_price=1e3*$(this).attr("id")),$the_sale_id=$(this).attr("data-sale_id"),$.ajax({url:"seatplan_ajax.php",data:"mode=live_discount"+$.ie+"&products_id="+$the_id+"&discount_id="+$the_sale_id+"&quantity=1&cPath="+$.cPath+"&new_price="+$the_price,dataType:"json",success:function(t){t.granted&&($.html='<span class="cht">'+t.show_name+'</span></br><span class="pn">'+(1<t.ga_in_cart?t.ga_in_cart+"x":"")+'<a href="'+$.baseurl+"product_info.php?products_id="+t.granted+'">'+t.products_name+'</a></span><span class="cnt">'+t.ga_in_cart+'</span><div id="del'+t.granted+'" class="bd"></div><span class="pp">'+lng.sym_left+(t.discount_price*t.ga_in_cart).toFixed(2)+lng.sym_right+"</span>",$("li#c"+t.granted).html($.html),$("div#ticket_discount").effect("transfer",{to:$("ul#ajax_cart")},120,function(){updateTotals()}),$("div#ticket_discount").fadeOut())}}),!1}),$(".xx").on("mouseout",function(){$("#discount_choice_text").html("")}),$(".xx").on("mouseover",function(){$("#discount_choice_text").html($(this).attr("data-choice_warning"))}),$("#kill_discount").on("click",function(){$("div#ticket_discount").fadeOut()}),1==$("input#qty").length&&$("input#qty").bind("keyup",function(){isNaN(parseInt($("input#qty").val()))&&$("input#qty").val("1"),$.qty=parseInt($("input#qty").val()),0!=product.discount_id?($.price=(product.saleMaker.sales[product.discount_id].price*$.qty).toFixed(2),$("span#totalProductsPrice").html(product.currency.symbolLeft+$.price+product.currency.symbolRight)):setTotalPrice()})}function countdown(){$("div#ajax_status").html(lng.expiry+"<br> "+(new Date).clearTime().addSeconds(parseInt(count)).toString("mm:ss")),0<count?($.pct=count/$.lifetime*100,30<$.pct?$.col="Green":20<$.pct?$.col="Orange":$.col="Red",$("div#ajax_status").css({color:$.col}),--count):$.ajax({url:"seatplan_ajax.php",data:"mode=terminate"+$.ie+"&cPath="+$.cPath,dataType:"json",success:function(t){clearInterval($.tick),clearInterval($.free),clearInterval($.timer),0<$("div#easyTooltip").length&&$("div#easyTooltip").fadeOut(0),$("ul#ajax_cart").html('<li class="timedout">'+lng.expired+"</li>"),$("div.clear").html('<div id="cleared">'+lng.cleared+"</div>"),$("span#total_price").html(lng.sym_left+"0.00"+lng.sym_right),$("span#total_seats").html("0 "+lng.seats),$("li#ticket_count span").html("0 "+lng.seats),$("div#ajax_status").slideUp(400),$("div#btnCheckOut").fadeOut(200),$("div#res_display").fadeOut(200)}})}function mobileLayout(){var t=navigator.userAgent;-1==t.indexOf("Android")&&-1==t.indexOf("iPhone")||($("div.nav").children("a").css({height:"20px",paddingTop:"12px",paddingBottom:"8px"}),$("div.navSelect").children("a").css({height:"20px",paddingTop:"12px",paddingBottom:"8px"}),$("div.navGroup").children("a").css({height:"20px",paddingTop:"12px",paddingBottom:"8px"}))}function flip(t){return st=t.split(""),rt=st.reverse(),rt.join("")}function updateTotals(){$.cnt=0,$.sum=0,$.sum_res=0,$.each($("ul#ajax_cart").children("li"),function(t,a){$.sum+=parseFloat($(this).children(".pp").html().replace(lng.sym_left+lng.sym_right,"").replace(",","")),$.sum_res+=parseFloat($(this).children(".res").html()),$.cnt+=parseInt($(this).children(".cnt").html())}),isNaN($.sum)?$.sum="----":$.sum=$.sum.toFixed(2),$("span#total_price").html(lng.sym_left+$.sum.toFixed(2)+lng.sym_right),$("span#total_res_price").html(lng.sym_left+$.sum_res.toFixed(2)+lng.sym_right),$("span#total_seats").html(1==$.cnt?"1 "+lng.seat:$.cnt+" "+lng.seats),$("li#ticket_count span").html(1==$.cnt?"1 "+lng.seat:$.cnt+" "+lng.seats),0<$("span#cart_subtotal").length&&($("span#cart_subtotal").html("&nbsp;"+lng.sym_left+$.sum.toFixed(2)+lng.sym_right),0==parseInt($.sum)&&0<$("span#discount_notice").length&&$("span#discount_notice").remove()),0<$.cnt?$("div#btnCheckOut").css({display:"block"}):$("div#btnCheckOut").css({display:"none"}),0<$.sum_res?$("div#res_display").css({display:"block"}):$("div#res_display").css({display:"none"})}function bindInputQuantity(){$("input#qty").bind("keyup",function(){checkStock("")})}$.ie=0<window.navigator.userAgent.indexOf("MSIE ")||0<window.navigator.userAgent.indexOf("Trident/")?"_ie":"";var timer,running=!1,count=parseInt($.remaining);$(function(){mobileLayout(),bindTriggers(),void 0!==$.cPath&&0!=$.cPath?(loader(),1==$("div.seatplan").length&&($.tick=setInterval("loader();",$.refresh),$.free=setInterval("freeSeats();",24*$.refresh)),$.timeout&&0!=$.remaining&&($("div#ajax_status").fadeIn(0),$.timer=setInterval(countdown,1e3)),$("li.s").easyTooltip()):("object"==typeof product&&($.cPath=product.cPath,bindInputQuantity()),$.timeout&&0!=$.remaining&&($("div#ajax_status").fadeIn(0),$.timer=setInterval(countdown,1e3))),0<$("ul#ajax_cart").children("li.c").length&&$("div#btnCheckOut").fadeIn(0),0<$("div#res_display_total").length&&$("div#res_display").css({display:"block"})}),$(document).ready(function(){var t=window.box_office_refund_product;$(t).length&&($(t).css({"border-color":"red",color:"red"}),$("html, body").animate({scrollTop:$(t).offset().top-$("#triple_boxes").outerHeight()},2e3))});